<div class="container mt-5 d-flex justify-content-center">
  <div class="change-password-card card shadow-lg p-4">
    <h2 class="text-center mb-4 text-warning">Change Password</h2>
    <form
      #changePasswordForm="ngForm"
      (ngSubmit)="onSubmit(changePasswordForm)"
    >
      <div class="mb-3">
        <label class="form-label fw-bold">Current Password</label>
        <div class="input-group">
          <input
            [type]="currentPasswordVisible ? 'text' : 'password'"
            class="form-control"
            placeholder="Enter current password"
            name="currentPassword"
            [(ngModel)]="changePasswordData.currentPassword"
            #currentPassword="ngModel"
            required
            minlength="8"
            maxlength="16"
          />
          <button
            class="btn btn-secondary"
            type="button"
            (click)="toggleCurrentPasswordVisibility()"
          >
            <i
              [class]="currentPasswordVisible ? 'fa fa-eye-slash' : 'fa fa-eye'"
            ></i>
          </button>
        </div>
        <div
          class="text-danger small"
          *ngIf="currentPassword.invalid && currentPassword.touched"
        >
          <span *ngIf="currentPassword.errors?.['required']"
            >Current password is required.</span
          >
          <span *ngIf="currentPassword.errors?.['minlength']"
            >Password must be at least 8 characters long.</span
          >
          <span *ngIf="currentPassword.errors?.['maxlength']"
            >Password must be less than 16 characters long.</span
          >
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label fw-bold">New Password</label>
        <div class="input-group">
          <input
            [type]="newPasswordVisible ? 'text' : 'password'"
            class="form-control"
            placeholder="Enter new password"
            name="newPassword"
            [(ngModel)]="changePasswordData.newPassword"
            #newPassword="ngModel"
            required
            minlength="8"
            maxlength="16"
          />
          <button
            class="btn btn-secondary"
            type="button"
            (click)="toggleNewPasswordVisibility()"
          >
            <i
              [class]="newPasswordVisible ? 'fa fa-eye-slash' : 'fa fa-eye'"
            ></i>
          </button>
        </div>
        <div
          class="text-danger small"
          *ngIf="newPassword.invalid && newPassword.touched"
        >
          <span *ngIf="newPassword.errors?.['required']"
            >New password is required.</span
          >
          <span *ngIf="newPassword.errors?.['minlength']"
            >Password must be at least 8 characters long.</span
          >
          <span *ngIf="newPassword.errors?.['maxlength']"
            >Password must be less than 16 characters long.</span
          >
        </div>
      </div>

      <div class="d-flex justify-content-between gap-3">
        <button
          type="submit"
          class="btn btn-warning w-45"
          [disabled]="changePasswordForm.invalid"
        >
          Update Password
        </button>
        <button class="btn btn-outline-secondary w-45" routerLink="/profile">
          Back
        </button>
      </div>
    </form>

    @if (validationErrors) {
    <div class="alert alert-danger text-start mt-4">
      <ul class="list-unstyled">
        @for (error of validationErrors; track $index) {
        <li>{{ error.Description }}</li>
        }
      </ul>
    </div>
    }
  </div>
</div>
